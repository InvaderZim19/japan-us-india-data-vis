<!DOCTYPE html>
<html> 
  <head>
    <!-- Meta Tag -->
    <meta charset="utf-8">
    <!-- CSS Stylesheet -->
    <style type="text/css">
        svg {
    	   font: 10px sans-serif;
    	}

    	.caption {
    	  font-weight: bold;
    	}

    	.key path {
    	  display: none;
    	}

    	.key line {
    	  stroke: #000;
    	  shape-rendering: crispEdges;
    	}

    	.county-border {
    	  fill: none;
    	  stroke: #000;
    	  stroke-opacity: .3;
    	}
            
        .state-border {
          fill: none;
          stroke: #000;
          stroke-opacity: 1;
        }
      
        .tract-border {
          fill: none;
          stroke: #000;
          stroke-opacity: .3;
        }
        .path {

        }
    </style>
  </head>
  <body>
<!--
  	<script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="https://d3js.org/topojson.v1.min.js"></script>
    <script src="https://d3js.org/d3-queue.v3.min.js"></script>
-->
    
    <h1 style = "text-align:center; color:#E57373"><bold> Japan-US-India Data Visualization (wip) </bold></h1>
    <svg width="1000" height="1100"></svg>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://d3js.org/topojson.v2.min.js"></script>
    <script src="https://d3js.org/d3-array.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v1.min.js"></script>
    
    <script type="text/javascript">
      
      var svg = d3.select("svg"),
          width = +svg.attr("width"),
          height = +svg.attr("height");
        
        var scaleVal = 0.5;
        
      var projectionIND = d3.geoMercator()
          .scale(400)
          .center([70, 26])
          .translate([width / 2, height / 2]);
      
      var projectionUSA = d3.geoMercator()
          .scale(200)
          .center([-40, 50])
          .translate([width / 2, height / 2]);
      
      var projectionJPN = d3.geoMercator()
          .scale(500)
          .center([100, 39])
          .translate([width / 2, height / 2]);

      var pathIND = d3.geoPath(projectionIND);
      var pathUSA = d3.geoPath(projectionUSA);
      var pathJPN = d3.geoPath(projectionJPN);

      var color = d3.scaleThreshold()
          .domain([1, 10, 50, 200, 500, 1000, 2000, 4000])
          .range(d3.schemeOrRd[9]);

      var g = svg.append("g")
          .attr("class", "key")
          .attr("transform", "translate(0,40)");
      
      d3.json("India.json", function(error, map) {
        if (error) throw error;

        var tracts = topojson.feature(map, map.objects.IND_adm1);

         svg.append("g")
          .attr("class", "tract")
          .attr("clip-path", "url(#clip-land)")
          .selectAll("path")
          .data(d3.nest()
          .key(function(d) { return color(d.properties.ID_1 / d.properties.Shape_Area * 2.58999e6); })
          .entries(tracts.features.filter(function(d) { return d.properties.Shape_Area; })))
          .enter().append("path")
          .style("fill", function(d) { return d.key; })
          .attr("d", function(d) { return pathIND({type: "FeatureCollection", features: d.values}); });

        svg.append("path")
            .datum(topojson.feature(map, map.arcs))
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("stroke-opacity", 0.3)
            .attr("d", pathIND);
      });

      d3.json("USA.json", function(error, map) {
        if (error) throw error;

        var tracts = topojson.feature(map, map.objects.USA_adm1);

         svg.append("g")
          .attr("class", "tract")
          .attr("clip-path", "url(#clip-land)")
          .selectAll("path")
          .data(d3.nest()
          .key(function(d) { return color(d.properties.ID_1 / d.properties.Shape_Area * 2.58999e6); })
          .entries(tracts.features.filter(function(d) { return d.properties.Shape_Area; })))
          .enter().append("path")
          .style("fill", function(d) { return d.key; })
          .attr("d", function(d) { return pathUSA({type: "FeatureCollection", features: d.values}); });

        svg.append("path")
            .datum(topojson.feature(map, map.arcs))
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("stroke-opacity", 0.3)
            .attr("d", pathUSA);
      });
      
      d3.json("Japan.json", function(error, map) {
        if (error) throw error;

        var tracts = topojson.feature(map, map.objects.JPN_adm1);

         svg.append("g")
          .attr("class", "tract")
          .attr("clip-path", "url(#clip-land)")
          .selectAll("path")
          .data(d3.nest()
          .key(function(d) { return color(d.properties.ID_1 / d.properties.Shape_Area * 2.58999e6); })
          .entries(tracts.features.filter(function(d) { return d.properties.Shape_Area; })))
          .enter().append("path")
          .style("fill", function(d) { return d.key; })
          .attr("d", function(d) { return pathJPN({type: "FeatureCollection", features: d.values}); });

        svg.append("path")
            .datum(topojson.feature(map, map.arcs))
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("stroke-opacity", 0.3)
            .attr("d", pathJPN);
      });
      
    </script>
    
    
    <!-- Submission Info -->
    <div id="context"></div>
    <h4>Created by Karl Cassel and Amado Rubalcava</h4>
      
    <h4>Description: A visualization of (wip) </h4>
      
    <h4> Sources: </h4>
    <ul>
      <li> <a href="http://learnjsdata.com/read_data.html">How we read mutliple pieces of data.</a></li>
    </ul>
      
  </body>
</html>
