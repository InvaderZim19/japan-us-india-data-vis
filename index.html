<!DOCTYPE html>
<html> 
  <head>
    <!-- Meta Tag -->
    <meta charset="utf-8">
    <!-- CSS Stylesheet -->
    <style type="text/css">
        svg {
    	   font: 10px sans-serif;
    	}
    	.caption {
    	  font-weight: bold;
    	}
    	.key path {
    	  display: none;
    	}
    	.key line {
    	  stroke: #000;
    	  shape-rendering: crispEdges;
    	}
    	.county-border {
    	  fill: none;
    	  stroke: #000;
    	  stroke-opacity: .3;
    	}
            
        .state-border {
          fill: none;
          stroke: #000;
          stroke-opacity: 1;
        }
      
        .tract-border {
          fill: none;
          stroke: #000;
          stroke-opacity: .3;
        }
        .path {
        }
        .three-col {
            -webkit-column-count: 3;
            -webkit-column-gap: 20px;
            column-span: all;
        }
    </style>
  </head>
  <body>
<!--
  	<script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="https://d3js.org/topojson.v1.min.js"></script>
    <script src="https://d3js.org/d3-queue.v3.min.js"></script>
-->
    
    <h1 style = "text-align:center; color:#E57373"><bold> Japan-US-India Data Visualization (wip) </bold></h1>
    <svg width="1000" height="500"></svg>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://d3js.org/topojson.v2.min.js"></script>
    <script src="https://d3js.org/d3-array.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v1.min.js"></script>
    
    <script type="text/javascript">
      
      var svg = d3.select("svg"),
          width = 1100;
          height = 500;
        
        var scaleVal = 0.5;
        
      var projectionIND = d3.geoMercator()
          .scale(450)
          .center([70, 26])
          .translate([width / 2, height / 2]);
      
      var projectionUSA = d3.geoMercator()
          .scale(200)
          .center([-40, 50])
          .translate([width / 2, height / 2]);
      
      var projectionJPN = d3.geoMercator()
          .scale(600)
          .center([110, 39])
          .translate([width / 2, height / 2]);
      var pathIND = d3.geoPath(projectionIND);
      var pathUSA = d3.geoPath(projectionUSA);
      var pathJPN = d3.geoPath(projectionJPN);
      var color = d3.scaleThreshold()
          .domain([ 0, 10, 20, 30, 40, 50])
          .range(d3.schemeBlues[9]);
      var g = svg.append("g")
          .attr("class", "key")
          .attr("transform", "translate(0,40)");
      
      d3.json("India.json", function(error, map) {
        if (error) throw error;
        var tracts = topojson.feature(map, map.objects.IND_adm1);
         svg.append("g")
          .attr("class", "tract")
          .attr("clip-path", "url(#clip-land)")
          .selectAll("path")
          .data(d3.nest()
          .key(function(d) { return color((d.properties.percentage+11)*(50/61)); })
          .entries(tracts.features.filter(function(d) { return d.properties.percentage; })))
          .enter().append("path")
          .style("fill", function(d) { return d.key; })
          .attr("d", function(d) { return pathIND({type: "FeatureCollection", features: d.values}); });
        svg.append("path")
            .datum(topojson.feature(map, map.arcs))
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("stroke-opacity", 0.3)
            .attr("d", pathIND);
      });
      d3.json("USA.json", function(error, map) {
        if (error) throw error;
        var tracts = topojson.feature(map, map.objects.USA_adm1);
        console.log(map)
          svg.append("g")
          .attr("class", "tract")
          .attr("clip-path", "url(#clip-land)")
          .selectAll("path")
          .data(d3.nest()
          .key(function(d) { return color((d.properties.percentage +11)*(50/61)); })
          .entries(tracts.features.filter(function(d) { return d.properties.percentage; })))
          .enter().append("path")
          .style("fill", function(d) { return d.key; })
          .attr("d", function(d) { return pathUSA({type: "FeatureCollection", features: d.values}); });
        svg.append("path")
            .datum(topojson.feature(map, map.geometries))
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("stroke-opacity", 0.3)
            .attr("d", pathUSA);
      });
      
      d3.json("Japan.json", function(error, map) {
        if (error) throw error;
        var tracts = topojson.feature(map, map.objects.JPN_adm1);
         svg.append("g")
          .attr("class", "tract")
          .attr("clip-path", "url(#clip-land)")
          .selectAll("path")
          .data(d3.nest()
          .key(function(d) { return color((d.properties.percentage +11)*(50/61)); })
          .entries(tracts.features.filter(function(d) { return d.properties.percentage; })))
          .enter().append("path")
          .style("fill", function(d) { return d.key; })
          .attr("d", function(d) { return pathJPN({type: "FeatureCollection", features: d.values}); });
        svg.append("path")
            .datum(topojson.feature(map, map.arcs))
            .attr("fill", 255,255,255)
            .attr("stroke", "#000")
            .attr("stroke-opacity", 1)
            .attr("d", pathJPN);
      });
      
    </script>
    
    
    <!-- Submission Info -->
    <div id="context"></div>
    <h4>Created by Karl Cassel and Amado Rubalcava in collaboration with Suresh K Lodha and Ryan Brounley.</h4>
    
    <h4>Description: A visualization of (wip) </h4>
    
    <div id="three-col">
        <h4>Files Submitted: 
            <ul>
                <li>index.html</li>
                <li>Pop_USA.csv</li>
                <li>Pop_Japan2.csv</li>
                <li>Pop_India2.csv</li>
                <li>USA.json</li>
                <li>Japan.json</li>
                <li>India.json</li>
                <li>USA_adm1.shp</li>
                <li>USA_adm1.dbf</li>
                <li>JPN_adm1.shp</li>
                <li>JPN_adm1.dbf</li>
                <li>IND_adm1.shp</li>
                <li>IND_adm1.dbf</li>
            </ul>
        </h4>

        <h4>Data Sources:
            <ul>
                <li><a href="http://www.census.gov/2010census/data/apportionment-pop-text.php">USA</a></li>
                <li><a href="http://www.stat.go.jp/english/data/nenkan/pdf/yhyou02.pdf">Japan</a></li>
                <li><a href="http://www.census2011.co.in/">India</a></li>
            </ul>
        </h4>

        <h4> Sources: </h4>
        <ul>
          <li> <a href="http://learnjsdata.com/read_data.html">How we read mutliple pieces of data.</a></li>
        </ul>
    </div>
  </body>
</html>
